<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <title>–¢—Ä–µ–∫–µ—Ä –ø–æ—Ö—É–¥–µ–Ω–∏—è</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
        :root {
            font-size: 16px;
            color-scheme: light dark;
        }
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            margin: 0;
            padding: 8px;
            background: #f5f5f5;
            color: #111;
        }
        .app {
            max-width: 480px;
            margin: 0 auto;
            background: #ffffff;
            padding: 16px 14px 20px;
            border-radius: 14px;
            box-shadow: 0 4px 14px rgba(0,0,0,0.08);
        }
        h1 {
            font-size: 1.3rem;
            margin: 0 0 8px;
            text-align: center;
        }
        .subtitle {
            font-size: 0.85rem;
            text-align: center;
            color: #666;
            margin-bottom: 12px;
        }
        .row {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .field {
            display: flex;
            flex-direction: column;
            font-size: 0.85rem;
        }
        label { margin-bottom: 4px; }
        input[type="text"],
        input[type="number"],
        input[type="date"],
        textarea {
            padding: 10px 10px;
            border-radius: 10px;
            border: 1px solid #ccc;
            font-size: 0.9rem;
            background: #fff;
            color: #111;
        }
        textarea {
            min-height: 60px;
            resize: vertical;
        }
        input[type="checkbox"] { width: 20px; height: 20px; }
        .checkbox-row {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 4px;
        }
        button {
            cursor: pointer;
            border: none;
            border-radius: 999px;
            padding: 12px 18px;
            font-size: 0.95rem;
            margin-top: 10px;
        }
        .btn-primary {
            background: #222;
            color: white;
            width: 100%;
        }
        .btn-small { padding: 8px 12px; font-size: 0.8rem; }
        .btn-danger {
            background: #c62828;
            color: white;
            font-size: 0.8rem;
            padding: 4px 8px;
            border-radius: 999px;
        }
        .settings-card,
        .summary,
        .praise {
            margin-top: 10px;
            font-size: 0.85rem;
            padding: 10px;
            border-radius: 10px;
        }
        .settings-card { background: #fff7f0; }
        .settings-grid {
            display: flex;
            gap: 8px;
            margin-top: 6px;
        }
        .settings-grid .field { flex: 1 1 0; }
        .summary { background: #f0f7ff; }
        .summary-title { font-weight: 600; margin-bottom: 4px; }
        .summary-line { margin: 2px 0; }
        .summary-highlight { font-weight: 600; }
        .summary-ok { color: #2e7d32; }
        .summary-warn { color: #c62828; }
        .praise {
            background: #f3f9f2;
            border-left: 4px solid #81c784;
        }
        .praise-title { font-weight: 600; margin-bottom: 4px; }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 12px;
            font-size: 0.8rem;
            display: block;
            overflow-x: auto;
        }
        thead { background: #fafafa; }
        th, td {
            padding: 6px 4px;
            border-bottom: 1px solid #eee;
            text-align: left;
            white-space: nowrap;
        }
        th:last-child,
        td:last-child { text-align: right; }
        @media (max-width: 430px) {
            th:nth-child(8),
            td:nth-child(8) { display: none; } /* –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π */
        }
        @media (max-width: 390px) {
            th:nth-child(7),
            td:nth-child(7) { display: none; } /* –≥—Ä—É–¥—å */
        }

        /* –¢—ë–º–Ω–∞—è —Ç–µ–º–∞ –ø–æ —Å–∏—Å—Ç–µ–º–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ */
        @media (prefers-color-scheme: dark) {
            body {
                background: #050506;
                color: #f5f5f5;
            }
            .app {
                background: #111218;
                box-shadow: 0 4px 14px rgba(0,0,0,0.6);
            }
            input[type="text"],
            input[type="number"],
            input[type="date"],
            textarea {
                background: #1b1c23;
                border-color: #444;
                color: #f5f5f5;
            }
            .subtitle { color: #aaa; }
            .settings-card { background: #1b1410; }
            .summary { background: #10192a; }
            .praise { background: #122216; border-left-color: #4caf50; }
            table thead { background: #151620; }
            th, td { border-bottom-color: #333; }
        }
    </style>
</head>
<body>
<div class="app">
    <h1>–¢—Ä–µ–∫–µ—Ä –ø–æ—Ö—É–¥–µ–Ω–∏—è</h1>
    <div class="subtitle">–í–µ—Å, –∑–∞–º–µ—Ä—ã, –¥–æ—Ä–æ–∂–∫–∞ –∏ –¥–µ—Ñ–∏—Ü–∏—Ç –∫–∞–ª–æ—Ä–∏–π üñ§</div>

    <div class="settings-card">
        <div class="summary-title">–¶–µ–ª—å –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å</div>
        <div class="settings-grid">
            <div class="field">
                <label for="startWeight">–°—Ç–∞—Ä—Ç–æ–≤—ã–π –≤–µ—Å (–∫–≥)</label>
                <input type="number" step="0.1" id="startWeight" placeholder="68.0" />
            </div>
            <div class="field">
                <label for="goalWeight">–¶–µ–ª—å (–∫–≥)</label>
                <input type="number" step="0.1" id="goalWeight" placeholder="55.0" />
            </div>
        </div>
        <button class="btn-primary btn-small" id="saveSettingsBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ü–µ–ª—å</button>
        <div id="goalInfo" style="margin-top:6px;font-size:0.8rem;"></div>
    </div>

    <div class="row" style="margin-top: 14px;">
        <div class="field">
            <label for="date">–î–∞—Ç–∞</label>
            <input type="date" id="date" />
        </div>
        <div class="field">
            <label for="weight">–í–µ—Å (–∫–≥)</label>
            <input type="number" step="0.1" id="weight" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä, 68.0" />
        </div>
        <div class="field">
            <label for="minutes">–ú–∏–Ω—É—Ç –Ω–∞ –¥–æ—Ä–æ–∂–∫–µ</label>
            <input type="number" id="minutes" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä, 40" />
        </div>
        <div class="field">
            <label>–ó–∞–º–µ—Ä—ã (—Å–º)</label>
        </div>
        <div class="field">
            <label for="waist">–¢–∞–ª–∏—è</label>
            <input type="number" step="0.1" id="waist" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä, 70" />
        </div>
        <div class="field">
            <label for="hips">–ë—ë–¥—Ä–∞</label>
            <input type="number" step="0.1" id="hips" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä, 100" />
        </div>
        <div class="field">
            <label for="chest">–ì—Ä—É–¥—å</label>
            <input type="number" step="0.1" id="chest" placeholder="–ø–æ –∂–µ–ª–∞–Ω–∏—é" />
        </div>
        <div class="field">
            <label for="comment">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label>
            <textarea id="comment" placeholder="–°–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ, —á—Ç–æ –ø–æ–º–æ–≥–ª–æ –Ω–µ —Å–æ—Ä–≤–∞—Ç—å—Å—è..."></textarea>
        </div>
        <div class="field">
            <div class="checkbox-row">
                <input type="checkbox" id="calorieDeficit" />
                <label for="calorieDeficit">–î–µ—Ä–∂–∞–ª–∞ –¥–µ—Ñ–∏—Ü–∏—Ç –∫–∞–ª–æ—Ä–∏–π</label>
            </div>
        </div>
    </div>

    <button class="btn-primary" id="addEntryBtn">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å</button>

    <div class="summary" id="summary">
        –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ–∫–∞. –î–æ–±–∞–≤—å –ø–µ—Ä–≤—É—é –∑–∞–ø–∏—Å—å üòä
    </div>

    <div class="praise" id="praise" style="display:none;">
        <div class="praise-title">–ú–æ—Ç–∏–≤–∞—à–∫–∞ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è üíõ</div>
        <div id="praiseText"></div>
    </div>

    <table>
        <thead>
        <tr>
            <th>–î–∞—Ç–∞</th>
            <th>–í–µ—Å</th>
            <th>–¢–∞–ª–∏—è</th>
            <th>–ë—ë–¥—Ä–∞</th>
            <th>–ì—Ä—É–¥—å</th>
            <th>–ú–∏–Ω.</th>
            <th>–î–µ—Ñ–∏—Ü–∏—Ç</th>
            <th>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
            <th></th>
        </tr>
        </thead>
        <tbody id="entriesBody">
        </tbody>
    </table>
</div>

<script>
    const STORAGE_KEY = "weight_tracker_entries_v3";
    const SETTINGS_KEY = "weight_tracker_settings_v1";
    const DEFAULT_GOAL = 55.0;

    function loadEntries() {
        const raw = localStorage.getItem(STORAGE_KEY);
        if (!raw) return [];
        try { return JSON.parse(raw); }
        catch { return []; }
    }

    function saveEntries(entries) {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(entries));
    }

    function loadSettings() {
        const raw = localStorage.getItem(SETTINGS_KEY);
        if (!raw) return { startWeight: null, goalWeight: DEFAULT_GOAL };
        try { return JSON.parse(raw); }
        catch { return { startWeight: null, goalWeight: DEFAULT_GOAL }; }
    }

    function saveSettings(settings) {
        localStorage.setItem(SETTINGS_KEY, JSON.stringify(settings));
    }

    function formatDate(dateStr) {
        if (!dateStr) return "";
        const [y, m, d] = dateStr.split("-");
        return `${d}.${m}.${y}`;
    }

    function calculateStreak(entries) {
        let streak = 0;
        for (let i = entries.length - 1; i >= 0; i--) {
            if (entries[i].calorieDeficit) streak++;
            else break;
        }
        return streak;
    }

    function renderGoalInfo(settings, currentWeight) {
        const el = document.getElementById("goalInfo");
        const { startWeight, goalWeight } = settings;

        if (!startWeight && !currentWeight) {
            el.textContent = "–ó–∞–ø–æ–ª–Ω–∏ —Å—Ç–∞—Ä—Ç–æ–≤—ã–π –≤–µ—Å –∏ —Ü–µ–ª—å ‚Äî —è –±—É–¥—É —Å—á–∏—Ç–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ —Å–∫–æ–ª—å–∫–æ –æ—Å—Ç–∞–ª–æ—Å—å.";
            return;
        }

        const current = currentWeight || startWeight;
        if (!current || !goalWeight) {
            el.textContent = "–ù—É–∂–Ω—ã –¥–∞–Ω–Ω—ã–µ –æ –≤–µ—Å–µ –∏ —Ü–µ–ª–∏, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å.";
            return;
        }

        const totalDelta = startWeight ? (startWeight - current).toFixed(1) : null;
        const left = (current - goalWeight).toFixed(1);

        let text = `–¢–µ–∫—É—â–∏–π –≤–µ—Å: ${current.toFixed(1)} –∫–≥. –¶–µ–ª—å: ${goalWeight.toFixed(1)} –∫–≥. `;
        if (totalDelta !== null) text += `–ü—Ä–æ–≥—Ä–µ—Å—Å –æ—Ç —Å—Ç–∞—Ä—Ç–∞: ${totalDelta} –∫–≥. `;

        if (current <= goalWeight) {
            text += "–¶–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ –∏–ª–∏ –¥–∞–∂–µ –ø–µ—Ä–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–∞ üéâ";
        } else {
            text += `–û—Å—Ç–∞–ª–æ—Å—å –¥–æ —Ü–µ–ª–∏: ${left} –∫–≥. –¢—ã –Ω–∞ –ø—É—Ç–∏, –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Å—è üí™`;
        }
        el.textContent = text;
    }

    function renderTable() {
        const entries = loadEntries().sort((a, b) => a.date.localeCompare(b.date));
        const tbody = document.getElementById("entriesBody");
        tbody.innerHTML = "";

        entries.forEach((entry, index) => {
            const tr = document.createElement("tr");

            const tdDate = document.createElement("td");
            tdDate.textContent = formatDate(entry.date);
            tr.appendChild(tdDate);

            const tdWeight = document.createElement("td");
            tdWeight.textContent = entry.weight ? entry.weight.toFixed(1) : "";
            tr.appendChild(tdWeight);

            const tdWaist = document.createElement("td");
            tdWaist.textContent = entry.waist ? entry.waist.toFixed(1) : "";
            tr.appendChild(tdWaist);

            const tdHips = document.createElement("td");
            tdHips.textContent = entry.hips ? entry.hips.toFixed(1) : "";
            tr.appendChild(tdHips);

            const tdChest = document.createElement("td");
            tdChest.textContent = entry.chest ? entry.chest.toFixed(1) : "";
            tr.appendChild(tdChest);

            const tdMinutes = document.createElement("td");
            tdMinutes.textContent = entry.minutes || "";
            tr.appendChild(tdMinutes);

            const tdDeficit = document.createElement("td");
            tdDeficit.textContent = entry.calorieDeficit ? "–î–∞" : "–ù–µ—Ç";
            tr.appendChild(tdDeficit);

            const tdComment = document.createElement("td");
            tdComment.textContent = entry.comment || "";
            tr.appendChild(tdComment);

            const tdActions = document.createElement("td");
            const btnDelete = document.createElement("button");
            btnDelete.textContent = "√ó";
            btnDelete.className = "btn-danger";
            btnDelete.onclick = () => {
                const updated = loadEntries();
                updated.splice(index, 1);
                saveEntries(updated);
                renderTable();
                renderSummary();
                renderPraise();
            };
            tdActions.appendChild(btnDelete);
            tr.appendChild(tdActions);

            tbody.appendChild(tr);
        });
    }

    function renderSummary() {
        const entries = loadEntries().sort((a, b) => a.date.localeCompare(b.date));
        const summaryEl = document.getElementById("summary");
        const settings = loadSettings();

        if (entries.length === 0) {
            summaryEl.textContent = "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ–∫–∞. –î–æ–±–∞–≤—å –ø–µ—Ä–≤—É—é –∑–∞–ø–∏—Å—å üòä";
            renderGoalInfo(settings, null);
            return;
        }

        const first = entries[0];
        const last = entries[entries.length - 1];
        const prev = entries.length > 1 ? entries[entries.length - 2] : null;

        let currentWeight = last.weight || null;

        if (!settings.startWeight && first.weight) {
            settings.startWeight = first.weight;
            saveSettings(settings);
        }

        renderGoalInfo(settings, currentWeight);

        const days = entries.length;
        const diffTotal = (last.weight && first.weight)
            ? (last.weight - first.weight).toFixed(1)
            : null;

        const diffDay = (prev && last.weight && prev.weight)
            ? (last.weight - prev.weight).toFixed(1)
            : null;

        const deficitDays = entries.filter(e => e.calorieDeficit).length;
        const totalMinutes = entries.reduce((sum, e) => sum + (e.minutes || 0), 0);
        const streak = calculateStreak(entries);

        let html = "";
        html += `<div class="summary-title">–û–±—â–∞—è –∫–∞—Ä—Ç–∏–Ω–∞</div>`;
        html += `<div class="summary-line">–ó–∞–ø–∏—Å–µ–π: <span class="summary-highlight">${days}</span>, –≤—Å–µ–≥–æ –º–∏–Ω—É—Ç –Ω–∞ –¥–æ—Ä–æ–∂–∫–µ: <span class="summary-highlight">${totalMinutes}</span>.</div>`;

        if (diffTotal !== null) {
            html += `<div class="summary-line">–ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤–µ—Å–∞ –æ—Ç –ø–µ—Ä–≤–æ–π –∑–∞–ø–∏—Å–∏: <span class="summary-highlight">${diffTotal} –∫–≥</span> (—Å ${first.weight.toFixed(1)} –¥–æ ${last.weight.toFixed(1)}).</div>`;
        }

        if (diffDay !== null && diffDay !== "0.0") {
            const cls = parseFloat(diffDay) <= 0 ? "summary-ok" : "summary-warn";
            const signText = parseFloat(diffDay) < 0 ? "–º–∏–Ω—É—Å" : "–ø–ª—é—Å";
            html += `<div class="summary-line ${cls}">–°–µ–≥–æ–¥–Ω—è ${signText} ${Math.abs(diffDay)} –∫–≥ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—à–ª–æ–π –∑–∞–ø–∏—Å–∏.</div>`;
        }

        if (first.waist && last.waist) {
            const wDiff = (last.waist - first.waist).toFixed(1);
            const signText = parseFloat(wDiff) < 0 ? "–º–∏–Ω—É—Å" : "–ø–ª—é—Å";
            html += `<div class="summary-line">–¢–∞–ª–∏—è: ${signText} ${Math.abs(wDiff)} —Å–º (—Å ${first.waist.toFixed(1)} –¥–æ ${last.waist.toFixed(1)}).</div>`;
        }

        if (first.hips && last.hips) {
            const hDiff = (last.hips - first.hips).toFixed(1);
            const signText = parseFloat(hDiff) < 0 ? "–º–∏–Ω—É—Å" : "–ø–ª—é—Å";
            html += `<div class="summary-line">–ë—ë–¥—Ä–∞: ${signText} ${Math.abs(hDiff)} —Å–º (—Å ${first.hips.toFixed(1)} –¥–æ ${last.hips.toFixed(1)}).</div>`;
        }

        html += `<div class="summary-line">–î–Ω–µ–π —Å –¥–µ—Ñ–∏—Ü–∏—Ç–æ–º –ø–æ –∑–∞–ø–∏—Å—è–º: <span class="summary-highlight">${deficitDays}</span>.</div>`;
        html += `<div class="summary-line">–°–µ—Ä–∏—è –¥–Ω–µ–π –±–µ–∑ —Å—Ä—ã–≤–æ–≤ (–¥–µ—Ñ–∏—Ü–∏—Ç –ø–æ–¥—Ä—è–¥): <span class="summary-highlight">${streak}</span>.</div>`;

        summaryEl.innerHTML = html;
    }

    function renderPraise() {
        const entries = loadEntries().sort((a, b) => a.date.localeCompare(b.date));
        const praiseBox = document.getElementById("praise");
        const praiseTextEl = document.getElementById("praiseText");

        if (entries.length === 0) {
            praiseBox.style.display = "none";
            return;
        }

        const last = entries[entries.length - 1];
        const prev = entries.length > 1 ? entries[entries.length - 2] : null;
        const streak = calculateStreak(entries);

        let message = "";

        const today = new Date();
        const yyyy = today.getFullYear();
        const mm = String(today.getMonth() + 1).padStart(2, "0");
        const dd = String(today.getDate()).padStart(2, "0");
        const todayStr = `${yyyy}-${mm}-${dd}`;
        const isToday = last.date === todayStr;

        const diffDay = (prev && last.weight && prev.weight)
            ? (last.weight - prev.weight).toFixed(1)
            : null;

        if (last.calorieDeficit) {
            if (streak >= 7) {
                message = `–£ —Ç–µ–±—è —É–∂–µ ${streak} –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥ —Å –¥–µ—Ñ–∏—Ü–∏—Ç–æ–º ‚Äî —ç—Ç–æ –æ—á–µ–Ω—å —Å–∏–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã üëë –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!`;
            } else if (streak >= 3) {
                message = `–°–µ—Ä–∏—è –∏–∑ ${streak} –¥–Ω–µ–π —Å –¥–µ—Ñ–∏—Ü–∏—Ç–æ–º ‚Äî —Ç—ã —Ä–µ–∞–ª—å–Ω–æ –¥–µ—Ä–∂–∏—à—å—Å—è, —ç—Ç–æ –≤–∏–¥–Ω–æ üî•`;
            } else {
                message = `–°–µ–≥–æ–¥–Ω—è —Ç—ã –¥–µ—Ä–∂–∞–ª–∞ –¥–µ—Ñ–∏—Ü–∏—Ç ‚Äî –∫–∞–∂–¥—ã–π —Ç–∞–∫–æ–π –¥–µ–Ω—å –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç —Ç–µ–±—è –∫ —Ü–µ–ª–∏. –ì–æ—Ä–∂—É—Å—å —Ç–≤–æ–µ–π —Å—Ç–æ–π–∫–æ—Å—Ç—å—é üíõ`;
            }
        } else {
            message = `–î–∞–∂–µ –µ—Å–ª–∏ —Å–µ–≥–æ–¥–Ω—è –±–µ–∑ –¥–µ—Ñ–∏—Ü–∏—Ç–∞ ‚Äî —Ç—ã –≤—Å—ë —Ä–∞–≤–Ω–æ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ. –ì–ª–∞–≤–Ω–æ–µ, —á—Ç–æ —Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∞–µ—à—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏ –Ω–µ –±—Ä–æ—Å–∞–µ—à—å üí´`;
        }

        if (diffDay !== null && diffDay !== "0.0") {
            const delta = parseFloat(diffDay);
            if (delta < 0) {
                message += ` –ê –µ—â—ë –≤–µ—Å —Å–Ω–∏–∑–∏–ª—Å—è –Ω–∞ ${Math.abs(delta)} –∫–≥ —Å –ø—Ä–æ—à–ª–æ–π –∑–∞–ø–∏—Å–∏ ‚Äî —ç—Ç–æ –ø—Ä—è–º –≤–∏–¥–∏–º—ã–π —à–∞–≥ –≤–ø–µ—Ä—ë–¥ üåü`;
            } else if (delta > 0 && isToday) {
                message += ` –ù–µ–±–æ–ª—å—à–æ–π –ø–ª—é—Å ${delta} –∫–≥ ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –≤–µ—Å –≤—Å–µ–≥–¥–∞ –Ω–µ–º–Ω–æ–≥–æ –≥—É–ª—è–µ—Ç. –í–∞–∂–µ–Ω —Ç—Ä–µ–Ω–¥, –∞ –Ω–µ –æ–¥–∏–Ω –¥–µ–Ω—å üìâ`;
            }
        }

        if (last.waist && prev && prev.waist) {
            const wDiffDay = (last.waist - prev.waist).toFixed(1);
            if (wDiffDay !== "0.0") {
                const delta = parseFloat(wDiffDay);
                if (delta < 0) {
                    message += ` –¢–∞–ª–∏—è —Å—Ç–∞–ª–∞ –º–µ–Ω—å—à–µ –µ—â—ë –Ω–∞ ${Math.abs(delta)} —Å–º ‚Äî –æ–¥–µ–∂–¥–∞ —ç—Ç–æ —Ç–æ—á–Ω–æ –∑–∞–º–µ—Ç–∏—Ç üëó`;
                }
            }
        }

        if (isToday) {
            message += ` –ò —Ç—ã —É–∂–µ —Å–¥–µ–ª–∞–ª–∞ —à–∞–≥ –¥–ª—è —Å–µ–±—è —Å–µ–≥–æ–¥–Ω—è, –ø—Ä–æ—Å—Ç–æ –∑–∞–ø–æ–ª–Ω–∏–≤ —Ç—Ä–µ–∫–µ—Ä. –≠—Ç–æ –∏ –µ—Å—Ç—å ¬´–Ω–µ —Å—Ä—ã–≤–∞—Ç—å—Å—è¬ª üå±`;
        }

        praiseTextEl.textContent = message;
        praiseBox.style.display = "block";
    }

    function initTodayDate() {
        const dateInput = document.getElementById("date");
        if (!dateInput.value) {
            const today = new Date();
            const yyyy = today.getFullYear();
            const mm = String(today.getMonth() + 1).padStart(2, "0");
            const dd = String(today.getDate()).padStart(2, "0");
            dateInput.value = `${yyyy}-${mm}-${dd}`;
        }
    }

    function initSettingsUI() {
        const settings = loadSettings();
        const entries = loadEntries().sort((a, b) => a.date.localeCompare(b.date));
        const startWeightInput = document.getElementById("startWeight");
        const goalWeightInput = document.getElementById("goalWeight");

        if (settings.startWeight) {
            startWeightInput.value = settings.startWeight;
        } else if (entries.length > 0 && entries[0].weight) {
            startWeightInput.value = entries[0].weight;
        }

        if (settings.goalWeight) {
            goalWeightInput.value = settings.goalWeight;
        } else {
            goalWeightInput.value = DEFAULT_GOAL;
        }
    }

    document.getElementById("addEntryBtn").addEventListener("click", () => {
        const date = document.getElementById("date").value;
        const weight = parseFloat(document.getElementById("weight").value);
        const minutes = parseInt(document.getElementById("minutes").value || "0", 10);
        const waist = parseFloat(document.getElementById("waist").value);
        const hips = parseFloat(document.getElementById("hips").value);
        const chest = parseFloat(document.getElementById("chest").value);
        const comment = document.getElementById("comment").value.trim();
        const calorieDeficit = document.getElementById("calorieDeficit").checked;

        if (!date) {
            alert("–í—ã–±–µ—Ä–∏ –¥–∞—Ç—É");
            return;
        }
        if (isNaN(weight)) {
            alert("–í–≤–µ–¥–∏ –≤–µ—Å");
            return;
        }

        const entry = {
            date,
            weight,
            minutes,
            waist: isNaN(waist) ? null : waist,
            hips: isNaN(hips) ? null : hips,
            chest: isNaN(chest) ? null : chest,
            comment,
            calorieDeficit
        };

        const entries = loadEntries();
        entries.push(entry);
        saveEntries(entries);

        document.getElementById("minutes").value = "";
        document.getElementById("waist").value = "";
        document.getElementById("hips").value = "";
        document.getElementById("chest").value = "";
        document.getElementById("comment").value = "";
        document.getElementById("calorieDeficit").checked = false;

        renderTable();
        renderSummary();
        renderPraise();
        alert("–ó–∞–ø–∏—Å—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ ‚úÖ");
    });

    document.getElementById("saveSettingsBtn").addEventListener("click", () => {
        const startWeightVal = parseFloat(document.getElementById("startWeight").value);
        const goalWeightVal = parseFloat(document.getElementById("goalWeight").value);

        const settings = {
            startWeight: isNaN(startWeightVal) ? null : startWeightVal,
            goalWeight: isNaN(goalWeightVal) ? DEFAULT_GOAL : goalWeightVal
        };

        saveSettings(settings);
        renderSummary();
        alert("–¶–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ üí™");
    });

    // —Å—Ç–∞—Ä—Ç
    initTodayDate();
    initSettingsUI();
    renderTable();
    renderSummary();
    renderPraise();
</script>
</body>
</html>
